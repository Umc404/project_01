<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Key Remover</title>
</head>
<body>
    <input type="file" id="fileInput" />
    <br/>
    <label for="keysInput">Keys to Remove (comma-separated):</label>
    <input type="text" id="keysInput" placeholder="e.g. key1,key2,key3" />
    <br/>
    <button id="processButton">Process File</button>
    <a id="downloadLink" style="display:none">Download Updated JSON</a>

    <script>
        document.getElementById('processButton').addEventListener('click', () => {
            const fileInput = document.getElementById('fileInput');
            const keysInput = document.getElementById('keysInput');

            if (fileInput.files.length === 0) {
                alert('Please select a file first.');
                return;
            }

            const keysToRemove = keysInput.value.split(',').map(key => key.trim()).filter(key => key.length > 0);
            if (keysToRemove.length === 0) {
                alert('Please enter at least one key to remove.');
                return;
            }

            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onload = function(event) {
                let jsonData;
                try {
                    jsonData = JSON.parse(event.target.result);
                } catch (error) {
                    alert('Invalid JSON file.');
                    return;
                }

                // 특정 키 제거
                function removeKeysFromJson(obj, keysToRemove) {
                    for (const key in obj) {
                        if (obj.hasOwnProperty(key)) {
                            if (keysToRemove.includes(key)) {
                                delete obj[key];
                            } else if (typeof obj[key] === 'object' && obj[key] !== null) {
                                removeKeysFromJson(obj[key], keysToRemove);
                            }
                        }
                    }
                }

                removeKeysFromJson(jsonData, keysToRemove);

                // 수정된 JSON을 Blob으로 만들어서 다운로드 링크 생성
                const updatedJson = JSON.stringify(jsonData, null, 2);
                const blob = new Blob([updatedJson], { type: 'application/json' });
                const url = URL.createObjectURL(blob);

                const downloadLink = document.getElementById('downloadLink');
                downloadLink.href = url;
                downloadLink.download = 'updated-data.json';
                downloadLink.style.display = 'block';
                downloadLink.textContent = 'Download Updated JSON';
            };

            reader.readAsText(file);
        });
    </script>
</body>
</html>
